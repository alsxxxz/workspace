<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="author" content="hissam" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SSAFY 15기 스타트캠프</title>

    <link rel="shortcut icon" href="./img/favicon.ico" />
    <link rel="stylesheet" href="./css/chatGPT.css" />

    <!-- axios -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  </head>

  <body>
    <!-- header 영역 start -->
    <header class="site-header">
      <div class="header-inner">
        <a href="./index.html" class="brand">
          <img src="./img/logo_square.png" class="brand-logo" alt="SSAFY" />
        </a>

        <nav class="nav nav-left">
          <a href="./wordcloud.html" class="nav-link">관심사보기</a>
        </nav>

        <nav class="nav nav-mid">
          <a href="./chatGPT.html" class="nav-link">Chat GPT에게 물어보기</a>
        </nav>

        <div class="profile">
          <img class="profile-img" alt="" src="./img/profile.png" />
        </div>

        <div class="auth">
          <a href="#" class="nav-link">로그인</a>
        </div>

        <div class="auth">
          <a href="#_" class="btn btn-primary">회원가입</a>
        </div>
      </div>
    </header>
    <!-- header 영역 end -->

    <!-- center 영역 start -->
    <main class="page">
      <section class="title-wrap">
        <div class="title-card">
          <div class="title-card-inner">
            <h2 class="page-title">Chat GPT를 활용한 추천 서비스</h2>
          </div>
        </div>
      </section>

      <section class="content">
        <div class="prompt-row">
          <div class="prompt-group">
            <form id="search-form">
              <span class="logo-badge" aria-hidden="true">
                <!-- 기존 SVG 유지 -->
                <svg
                  width="41"
                  height="41"
                  viewBox="0 0 41 41"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                  class="chatgpt-logo"
                  role="img"
                >
                  <text x="-9999" y="-9999">ChatGPT</text>
                  <path
                    d="M37.5324 16.8707C37.9808 15.5241 38.1363 14.0974 37.9886 12.6859C37.8409 11.2744 37.3934 9.91076 36.676 8.68622C35.6126 6.83404 33.9882 5.3676 32.0373 4.4985C30.0864 3.62941 27.9098 3.40259 25.8215 3.85078C24.8796 2.7893 23.7219 1.94125 22.4257 1.36341C21.1295 0.785575 19.7249 0.491269 18.3058 0.500197C16.1708 0.495044 14.0893 1.16803 12.3614 2.42214C10.6335 3.67624 9.34853 5.44666 8.6917 7.47815C7.30085 7.76286 5.98686 8.3414 4.8377 9.17505C3.68854 10.0087 2.73073 11.0782 2.02839 12.312C0.956464 14.1591 0.498905 16.2988 0.721698 18.4228C0.944492 20.5467 1.83612 22.5449 3.268 24.1293C2.81966 25.4759 2.66413 26.9026 2.81182 28.3141C2.95951 29.7256 3.40701 31.0892 4.12437 32.3138C5.18791 34.1659 6.8123 35.6322 8.76321 36.5013C10.7141 37.3704 12.8907 37.5973 14.9789 37.1492C15.9208 38.2107 17.0786 39.0587 18.3747 39.6366C19.6709 40.2144 21.0755 40.5087 22.4946 40.4998C24.6307 40.5054 26.7133 39.8321 28.4418 38.5772C30.1704 37.3223 31.4556 35.5506 32.1119 33.5179C33.5027 33.2332 34.8167 32.6547 35.9659 31.821C37.115 30.9874 38.0728 29.9178 38.7752 28.684C39.8458 26.8371 40.3023 24.6979 40.0789 22.5748C39.8556 20.4517 38.9639 18.4544 37.5324 16.8707Z"
                    fill="currentColor"
                  ></path>
                  <path
                    d="M16.071 17.9991L20.4018 15.4978L24.7325 17.9975V22.9985L20.4018 25.4983L16.071 22.9985V17.9991Z"
                    fill="currentColor"
                  ></path>
                </svg>
              </span>

              <span class="prompt-text">
                Chat GPT야
                <input
                  id="keyword"
                  class="input-keyword"
                  placeholder="추천 단어..."
                  autocomplete="off"
                />
                와(과) 관련된 토론주제 10개만 추천해줘!!!
              </span>

              <button class="btn btn-pink" type="submit">물어보기</button>
            </form>
          </div>
        </div>

        <div class="result-wrap">
          <div id="resultView" class="result-view" aria-live="polite"></div>
        </div>
      </section>
    </main>
    <!-- center 영역 end -->

    <!-- footer 영역 start -->
    <footer class="site-footer">
      <span class="footer-text">
        © 2026
        <a href="https://www.ssafy.com" class="footer-link" target="_blank" rel="noreferrer"
          >SSAFY</a
        >. Copyright &copy; SAMSUNG All Rights Reserved.
      </span>

      <ul class="footer-links">
        <li><a href="#" class="footer-link">지원하기</a></li>
        <li><a href="#" class="footer-link">이용문의</a></li>
        <li><a href="#" class="footer-link">이용약관</a></li>
        <li><a href="#" class="footer-link">개인정보처리방침</a></li>
      </ul>
    </footer>
    <!-- footer 영역 end -->

	<script>
	  const GMS_KEY = "==========GMS KEY 입력============";
	  const MODEL = "gpt-5-nano";
	  const END_POINT = "https://api.openai.com/v1/chat/completions";
	
	  const keywordInput = document.querySelector("#keyword");
	  const searchForm = document.querySelector("#search-form");
	  const resultView = document.querySelector("#resultView");
	
	  searchForm.addEventListener("submit", async (e) => {
	    e.preventDefault();
	
	    const keyword = keywordInput.value.trim();
	
	    if (!keyword) {
	      resultView.innerHTML = "<p style='color:red;'>키워드를 입력해 주세요.</p>";
	      keywordInput.focus();
	      return;
	    }
	
	    const config = {
	      headers: {
	        Authorization: `Bearer ${GMS_KEY}`,
	        "Content-Type": "application/json",
	      },
	    };
	
	    const data = {
	      model: MODEL,
	      messages: [
	        {
	          role: "user",
	          content: `${keyword}와 관련된 토론주제 10개만 추천해줘!!!`,
	        },
	      ],
	    };
	
	    // 로딩 표시
	    resultView.innerHTML = `<img src="./img/loading.gif" width="300px" alt="loading" />`;
	
	    try {
	      const response = await axios.post(END_POINT, data, config);
	
	      resultView.innerHTML = "";
	
	      response.data.choices.forEach((choice) => {
	        const contentLines = choice.message.content.split("\n");
	
	        contentLines.forEach((line) => {
	          if (!line.trim()) return;
	
	          resultView.innerHTML += `
	        	  <div style="margin-top:16px; padding-left:12px; border-left:3px dotted #ccc;">
	        	    ${line}
	        	  </div>
	        	`;
	        });
	      });
	    } catch (error) {
	      console.error(error);
	      resultView.innerHTML = `<p style="color:red;">요청 중 오류가 발생했습니다. (API Key / 모델 / 네트워크 확인)</p>`;
	    }
	  });
	</script>

  </body>
</html>
